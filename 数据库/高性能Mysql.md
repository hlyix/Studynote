# Chapter 1 Mysql架构与历史
## 1.1 Mysql的逻辑架构
分为三层：
1. 最上层大多数是基于网络的客户端/服务器的工具或者服务都有类似的架构。
2. 第二层包含了大多数Mysql的核心服务功能都在这一层，包括查询解析、分析、优化、缓存以及所有的内置函数。所有跨储存引擎的功能都在这一层实现：存储过程、触发器、视图等。
3. 第三层就包含了存储引擎。

### 1.1.1 连接管理和安全性
 Mysql服务器在每个客户端连接进来时都会为其创建一个线程，该线程只能轮流在某个CPU核心或者CPU内运行，Mysql服务器会缓存这些线程（线程池），节约创建和销毁线程的时间。
 当客户端连接到Mysql服务器时，服务器需要对其进行认证。认证基于用户名、原始主机的信息和密码。如果使用了安全套接字（SSL）的连接方式，还可以使用X.509证书认证。一旦客户端连接成功，服务器会继续验证该客户端是否具有某个特定查询的权限。

### 1.1.2 优化和执行
Mysql会解析查询，并创建内部数据结构（解析树），然后对其进行各种优化，包括重写查询、决定表的读取顺序，以及选择合适的索引等。（第6章）
优化器并不关心表使用的时什么存储引擎。优化器会请求存储引擎提供容量或某个具体操作的开销信息，以及表数据的统计信息等。（第4章和第5章）
对于select语句，在解析之前服务器会先检查查询缓存，如果能在缓存中找到对应的查询结果，服务器就不必再执行查询解析、优化和执行的整个过程。

## 1.2 并发控制
### 1.2.1 读写锁